const { Markup } = require('telegraf');

module.exports = (bot) => {
    bot.command('start', async (ctx) => {
        const param = ctx.message.text.split(' ')[1];
        
        if (param?.startsWith('crypto_success_')) {
            const userId = param.split('_')[2];
            if (ctx.from.id.toString() === userId) {
                await ctx.reply('ะกะฟะฐัะธะฑะพ ะทะฐ ะพะฟะปะฐัั ะบัะธะฟัะพะฒะฐะปััะพะน! ะะฐั VPN ะบะปัั ะฑัะดะตั ะพัะฟัะฐะฒะปะตะฝ ะฒ ัะตัะตะฝะธะต ะผะธะฝััั.');
                return;
            }
        }
        
        if (param === 'payment_success') {
            await ctx.reply('ะกะฟะฐัะธะฑะพ ะทะฐ ะพะฟะปะฐัั! ะะถะธะดะฐะนัะต ะฟะพะปััะตะฝะธั VPN ะบะปััะฐ.');
            return;
        }
        
        if (param === 'payment_fail') {
            await ctx.reply('ะ ัะพะถะฐะปะตะฝะธั, ะพะฟะปะฐัะฐ ะฝะต ะฟัะพัะปะฐ. ะะพะถะฐะปัะนััะฐ, ะฟะพะฟัะพะฑัะนัะต ัะฝะพะฒะฐ ะธะปะธ ะพะฑัะฐัะธัะตัั ะฒ ะฟะพะดะดะตัะถะบั.');
            return;
        }

        // ะะปะฐะฒะฝะพะต ะผะตะฝั
        await ctx.reply(
            'โก ะะพะฑัะพ ะฟะพะถะฐะปะพะฒะฐัั ะฒ ZeusVPN!\n\n' +
            '๐ ะงัะพ ัะผะตะตั ะฝะฐั VPN:\n' +
            '๐ ะัััััะน ะธ ะฝะฐะดะตะถะฝัะน VPN-ะดะพัััะฟ\n' +
            '๐ฑ ะะฐะฑะพัะฐะตั ะฝะฐ ะฒัะตั ััััะพะนััะฒะฐั\n' +
            'โ ะะตะทะปะธะผะธัะฝัะน ััะฐัะธะบ\n' +
            'โก ะััะพะบะฐั ัะบะพัะพััั\n\n' +
            '๐ ะกัะพะธะผะพััั: ะฒัะตะณะพ 100โฝ ะฒ ะผะตััั\n\n' +
            '๐ฟ ะะฐะถะผะธัะต "ะัะฟะธัั ZeusVPN" ะดะปั ะพัะพัะผะปะตะฝะธั ะฟะพะดะฟะธัะบะธ',
            Markup.keyboard([
                ['๐ฃ ะัะฟะธัั ZeusVPN - 100โฝ/ะผะตััั'],
                ['๐ ะะฝััััะบัะธั ะฟะพ ัััะฐะฝะพะฒะบะต'],
                ['๐ฆ ะะพะธ ะบะปััะธ']
            ]).resize()
        );
    });

    // ะะฑัะฐะฑะพััะธะบ ะบะฝะพะฟะบะธ ะฟะพะบัะฟะบะธ
    bot.hears('๐ฃ ะัะฟะธัั ZeusVPN - 100โฝ/ะผะตััั', async (ctx) => {
        await ctx.reply(
            '๐ฃ ะัะพัะผะปะตะฝะธะต ะฟะพะดะฟะธัะบะธ ZeusVPN\n\n' +
            '๐ ะงัะพ ะฒัะพะดะธั ะฒ ะฟะพะดะฟะธัะบั:\n' +
            '๐ ะะตะทะปะธะผะธัะฝัะน ััะฐัะธะบ\n' +
            'โก๏ธ ะััะพะบะฐั ัะบะพัะพััั\n' +
            '๐ฑ ะะพัััะฟ ัะพ ะฒัะตั ััััะพะนััะฒ\n' +
            '๐ก ะะฐะดะตะถะฝะฐั ะทะฐัะธัะฐ\n' +
            '๐ฟ ะขะตัะฝะธัะตัะบะฐั ะฟะพะดะดะตัะถะบะฐ\n\n' +
            '๐ ะกัะพะธะผะพััั: 100โฝ/ะผะตััั\n\n' +
            '๐ณ ะกะฟะพัะพะฑั ะพะฟะปะฐัั:\n' +
            'โข ะะฐะฝะบะพะฒัะบะฐั ะบะฐััะฐ\n' +
            'โข ะัะธะฟัะฐ',
            Markup.keyboard([
                ['๐ณ ะะฟะปะฐัะธัั ะบะฐััะพะน'],
                ['๐ช ะะฟะปะฐัะธัั ะบัะธะฟัะพะน'],
                ['โ๏ธ ะะฐะทะฐะด ะฒ ะผะตะฝั']
            ]).resize()
        );
    });

    // ะะฑัะฐะฑะพััะธะบ ะบะฝะพะฟะบะธ "ะะพะธ ะบะปััะธ"
    bot.hears('๐ฆ ะะพะธ ะบะปััะธ', async (ctx) => {
        const userId = ctx.from.id;
        // ะะดะตัั ะฝัะถะฝะพ ะดะพะฑะฐะฒะธัั ะฟัะพะฒะตัะบั ะบะปััะตะน ะฟะพะปัะทะพะฒะฐัะตะปั ะฒ ะฑะฐะทะต ะดะฐะฝะฝัั
        await ctx.reply(
            '๐ฆ ะะฐัะธ ะฐะบัะธะฒะฝัะต ะบะปััะธ:\n\n' +
            'ะฃ ะฒะฐั ะฟะพะบะฐ ะฝะตั ะฐะบัะธะฒะฝัั ะบะปััะตะน.\n' +
            'ะะปั ะฟะพะปััะตะฝะธั ะบะปััะฐ ะฝะฐะถะผะธัะต "ะัะฟะธัั ZeusVPN"',
            Markup.keyboard([
                ['๐ฃ ะัะฟะธัั ZeusVPN - 100โฝ/ะผะตััั'],
                ['โ๏ธ ะะฐะทะฐะด ะฒ ะผะตะฝั']
            ]).resize()
        );
    });

    // ะะฑัะฐะฑะพััะธะบ ะบะฝะพะฟะบะธ "ะะฝััััะบัะธั ะฟะพ ัััะฐะฝะพะฒะบะต"
    bot.hears('๐ ะะฝััััะบัะธั ะฟะพ ัััะฐะฝะพะฒะบะต', async (ctx) => {
        await ctx.reply(
            '๐ ะัะฑะตัะธัะต ะฒะฐัั ะพะฟะตัะฐัะธะพะฝะฝัั ัะธััะตะผั\nะดะปั ะฟะพะปััะตะฝะธั ะธะฝััััะบัะธะน ะฟะพ ัััะฐะฝะพะฒะบะต:',
            Markup.keyboard([
                ['๐ฑ Android'],
                ['๐ iOS/iPhone'],
                ['๐ช Windows'],
                ['๐ง Linux'],
                ['๐ macOS'],
                ['โ๏ธ ะะฐะทะฐะด ะฒ ะผะตะฝั']
            ]).resize()
        );
    });

    // ะะฑัะฐะฑะพััะธะบะธ ะดะปั ะบะฐะถะดะพะน ะะก
    const osInstructions = {
        '๐ฑ Android': `
1. ะฃััะฐะฝะพะฒะธัะต ะฟัะธะปะพะถะตะฝะธะต Outline:
โข ะัะบัะพะนัะต Google Play Store: https://play.google.com/store/apps/details?id=org.outline.android.client
โข ะะปะธ ัะบะฐัะฐะนัะต ะฝะฐะฟััะผัั ั ัะฐะนัะฐ: https://getoutline.org/get-started/#step-3

2. ะะพัะปะต ัััะฐะฝะพะฒะบะธ:
โข ะัะบัะพะนัะต ะฟัะธะปะพะถะตะฝะธะต
โข ะะฐะถะผะธัะต "ะะพะฑะฐะฒะธัั ัะตัะฒะตั"
โข ะััะฐะฒััะต ะฟะพะปััะตะฝะฝัะน ะบะปัั ะดะพัััะฟะฐ
โข ะะฐะถะผะธัะต "ะะพะดะบะปััะธัััั"

3. ะะพัะพะฒะพ! ะะฐั VPN ะฟะพะดะบะปััะตะฝ`,

        '๐ iOS/iPhone': `
1. ะฃััะฐะฝะพะฒะธัะต ะฟัะธะปะพะถะตะฝะธะต Outline:
โข ะัะบัะพะนัะต App Store: https://apps.apple.com/app/outline-app/id1356177741
โข ะะปะธ ัะบะฐัะฐะนัะต ัะตัะตะท ัะฐะนั: https://getoutline.org/get-started/#step-3

2. ะะพัะปะต ัััะฐะฝะพะฒะบะธ:
โข ะัะบัะพะนัะต ะฟัะธะปะพะถะตะฝะธะต
โข ะะฐะถะผะธัะต "ะะพะฑะฐะฒะธัั ัะตัะฒะตั"
โข ะััะฐะฒััะต ะฟะพะปััะตะฝะฝัะน ะบะปัั ะดะพัััะฟะฐ
โข ะะฐะทัะตัะธัะต ัััะฐะฝะพะฒะบั VPN ะฟัะพัะธะปั
โข ะะฐะถะผะธัะต "ะะพะดะบะปััะธัััั"

3. ะะพัะพะฒะพ! ะะฐั VPN ะฟะพะดะบะปััะตะฝ`,

        '๐ช Windows': `
1. ะกะบะฐัะฐะนัะต Outline Client:
โข ะกะบะฐัะฐะนัะต ัััะฐะฝะพะฒัะธะบ: https://raw.githubusercontent.com/Jigsaw-Code/outline-releases/master/client/stable/Outline-Client.exe
โข ะะปะธ ัะตัะตะท ัะฐะนั: https://getoutline.org/get-started/#step-3

2. ะฃััะฐะฝะพะฒะบะฐ:
โข ะะฐะฟัััะธัะต ัะบะฐัะฐะฝะฝัะน ัะฐะนะป
โข ะกะปะตะดัะนัะต ะธะฝััััะบัะธัะผ ัััะฐะฝะพะฒัะธะบะฐ
โข ะะพะถะดะธัะตัั ะทะฐะฒะตััะตะฝะธั ัััะฐะฝะพะฒะบะธ

3. ะะฐัััะพะนะบะฐ:
โข ะะฐะฟัััะธัะต Outline Client
โข ะะฐะถะผะธัะต "Add server"
โข ะััะฐะฒััะต ะฟะพะปััะตะฝะฝัะน ะบะปัั ะดะพัััะฟะฐ
โข ะะฐะถะผะธัะต "Connect"

4. ะะพัะพะฒะพ! ะะฐั VPN ะฟะพะดะบะปััะตะฝ`,

        '๐ง Linux': `
1. ะกะบะฐัะฐะนัะต Outline Client:
โข ะกะบะฐัะฐะนัะต AppImage: https://raw.githubusercontent.com/Jigsaw-Code/outline-releases/master/client/stable/Outline-Client.AppImage
โข ะะปะธ ัะตัะตะท ัะฐะนั: https://getoutline.org/get-started/#step-3

2. ะฃััะฐะฝะพะฒะบะฐ:
โข ะัะบัะพะนัะต ัะตัะผะธะฝะฐะป
โข ะกะดะตะปะฐะนัะต ัะฐะนะป ะธัะฟะพะปะฝัะตะผัะผ:
  chmod +x Outline-Client.AppImage
โข ะะฐะฟัััะธัะต ะฟัะธะปะพะถะตะฝะธะต:
  ./Outline-Client.AppImage

3. ะะฐัััะพะนะบะฐ:
โข ะะฐะถะผะธัะต "Add server"
โข ะััะฐะฒััะต ะฟะพะปััะตะฝะฝัะน ะบะปัั ะดะพัััะฟะฐ
โข ะะฐะถะผะธัะต "Connect"

4. ะะพัะพะฒะพ! ะะฐั VPN ะฟะพะดะบะปััะตะฝ`,

        '๐ macOS': `
1. ะกะบะฐัะฐะนัะต Outline Client:
โข ะกะบะฐัะฐะนัะต DMG ัะฐะนะป: https://raw.githubusercontent.com/Jigsaw-Code/outline-releases/master/client/stable/Outline-Client.dmg
โข ะะปะธ ัะตัะตะท ัะฐะนั: https://getoutline.org/get-started/#step-3

2. ะฃััะฐะฝะพะฒะบะฐ:
โข ะัะบัะพะนัะต ัะบะฐัะฐะฝะฝัะน .dmg ัะฐะนะป
โข ะะตัะตัะฐัะธัะต Outline ะฒ ะฟะฐะฟะบั Applications
โข ะะฐะฟัััะธัะต ะฟัะธะปะพะถะตะฝะธะต

3. ะะฐัััะพะนะบะฐ:
โข ะะฐะถะผะธัะต "Add server"
โข ะััะฐะฒััะต ะฟะพะปััะตะฝะฝัะน ะบะปัั ะดะพัััะฟะฐ
โข ะะฐะทัะตัะธัะต ัััะฐะฝะพะฒะบั VPN ะบะพะฝัะธะณััะฐัะธะธ
โข ะะฐะถะผะธัะต "Connect"

4. ะะพัะพะฒะพ! ะะฐั VPN ะฟะพะดะบะปััะตะฝ`
    };

    Object.entries(osInstructions).forEach(([os, instruction]) => {
        bot.hears(os, async (ctx) => {
            await ctx.reply(instruction, Markup.keyboard([
                ['โ๏ธ ะะฐะทะฐะด ะฒ ะผะตะฝั']
            ]).resize());
        });
    });

    // ะะฑัะฐะฑะพััะธะบ ะบะฝะพะฟะบะธ "ะะฐะทะฐะด ะฒ ะผะตะฝั"
    bot.hears('โ๏ธ ะะฐะทะฐะด ะฒ ะผะตะฝั', async (ctx) => {
        await ctx.reply(
            'โก ะะพะฑัะพ ะฟะพะถะฐะปะพะฒะฐัั ะฒ ZeusVPN!\n\n' +
            '๐ ะงัะพ ัะผะตะตั ะฝะฐั VPN:\n' +
            '๐ ะัััััะน ะธ ะฝะฐะดะตะถะฝัะน VPN-ะดะพัััะฟ\n' +
            '๐ฑ ะะฐะฑะพัะฐะตั ะฝะฐ ะฒัะตั ััััะพะนััะฒะฐั\n' +
            'โ ะะตะทะปะธะผะธัะฝัะน ััะฐัะธะบ\n' +
            'โก ะััะพะบะฐั ัะบะพัะพััั\n\n' +
            '๐ ะกัะพะธะผะพััั: ะฒัะตะณะพ 100โฝ ะฒ ะผะตััั\n\n' +
            '๐ฟ ะะฐะถะผะธัะต "ะัะฟะธัั ZeusVPN" ะดะปั ะพัะพัะผะปะตะฝะธั ะฟะพะดะฟะธัะบะธ',
            Markup.keyboard([
                ['๐ฃ ะัะฟะธัั ZeusVPN - 100โฝ/ะผะตััั'],
                ['๐ ะะฝััััะบัะธั ะฟะพ ัััะฐะฝะพะฒะบะต'],
                ['๐ฆ ะะพะธ ะบะปััะธ']
            ]).resize()
        );
    });
}; 